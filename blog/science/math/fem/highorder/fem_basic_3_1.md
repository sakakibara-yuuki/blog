---
title: "高次有限要素法: 3.1 参照領域における射影補間"
author: "sakakibara"
description: "上手くいかないことがありましたが、コミュニティに質問して助けてもらいました！"
heroImage: "/science/science.jpg"
pubDate: 2024-03-24
tags: ["math", "fem", "有限要素法"]
---


# 高次有限要素の離散化
## 参照領域における射影補間
階層要素における射影補間は高次有限要素法の本質的な部分を形成する非自明な手法である。
nodal高次有限要素の構成を思い出してほしい。
階層要素に対して自由度$L_1, L_2, \ldots, L_{N_P}$は局所多項式空間$P(K)$の外部を定義しない。
つまり、定義1.7では階層要素に対する局所補間操作を設計するために利用できない。
よって、標準的なnodal補間(Lagrange補間)と高次多項式部分空間の射影を組み合わせる必要がある。

正則関数$u \in V(\Omega_h)$とし、適切な多項式補間の補間$u_{h,p}$, $V_{h, p}\subset V$を見つけることを目的とする。
アフィン要素変換$\bm{x}_ K: \hat{K} \to K$と任意の要素$K \in \mathcal{T}_ {h,p}$は参照領域上における補間関数$u|_ K \circ \bm{x}_ K$の間は等しい。
そこで、しばらくは参照領域上での議論をする。
物理的メッシュ要素への拡張は後に説明を行う。

#### 射影補間操作の性質
射影補間$\Pi$はアルゴリズム的な効果があり、収束理論と一致、互換性がある。
そこで、次の性質を要請する。
1. (局所性). 関数$u$の射影補間$\Pi u$は要素毎に構成される。よって、$\Pi$は注目している要素内からえられる$u$の関数値を使う。
2. (大局適合性). 任意の関数$u\in V^0$, $\bar{V^0}=V$に対して、射影補間$u_ {h,p}=\Pi u$は依然、$V$に属する。大域一致正は1.1.4章で導入したものを思い出してほしい。
    * (a) 要素境界での$V=H^1$連続性
    * (b) 要素境界での接線の$V=\bm{H}(\mathrm{curl})$連続性
    * (c) 要素境界での法線の$V=\bm{H}(\mathrm{div})$連続性
3. (最適性). 補間$u_{h, p} \in V_{h,p}$は適切なノルムにおいて補間関数$u\in V$から最小距離でなければならない。$H^1, \bm{H}(\mathrm{curl}), \bm{H}(\mathrm{div})$における適切なノルムの選定は非自明な数学的問題である。

#### $H^1$一致要素
$p^b \ge 1$次多項式の一次元基本要素$\mathcal{K}^1_a$つまり、以下の多項式空間を備えた要素を考える。
$$
W_a = \set{w| w\in \mathcal{P}_ {p^b}(K_a)}
$$
さらに、関数$u\in H^1(K_a)$について考える。
1次元空間における階層形状関数は頂点関数$\varphi_a^{v_1}, \varphi_a^{v_2}$は(2.6)で定義され、気泡関数$\varphi_{k, a}^b,\ k=2, 3,\ldots, p^b$は(2.8)で定義される。
射影補間$u_{h, p} = \Pi_a^1,\ u\in W_a$は頂点補間と気泡補間の和で構成される。
$$
u_{h,p} = u_{h,p}^v + u_{h,p}^b
$$
頂点補間$u^v_{h,p} \in W_a$は線形関数であり、両端では$u$は以下のようになる。
$$
u^v_{h,p}(\pm 1) = u(\pm 1)
$$

気泡補間$u^b_{h, p} \in W_a$は残差$u-u^v_{h,p}$の$\mathcal{P}_ {p^b, 0}(K_a)$上の射影によって得られる。
(ここで、多項式は両端で$0$となるとする。)。
$H^1$の半ノルムは
$$
|u - u^v_{h, p} - u^v_{h, p}|_ {H^1} \to \min
$$
$\mathcal{P}_ {p^b, 0}(K_a)$は関数空間$\varphi^b_{k, a}, k= 2, 3, \ldots, p^b$によって張られるので、気泡補間$u^b_{h,p}$は以下のように表現できる。
$$
u^b_{h,p} = \sum_{m=2}^{p^b} u^b_m \varphi^b_{m, a}
$$

離散最小化問題は$p^b-1$の未知の係数$\alpha^b_m$に対する線形代数方程式の系に等しく
$$
\int_{K_a}(u - u^v_{h,p} - u^b_{h,p})'(\varphi^b_{k,a})' = 0,\ k=2, 3, \ldots, p^b
$$

#### 補題(補間の一意性)
頂点補間$u^v_{h, p}$が非線形であるとする。
$p^b$以下の次数の多項式が選択され、$u_{h,p}$が一意に定まる。

#### $\mathcal{K}^1_t$:三角形の基本要素

辺において次数$p^{e_j}, j=1, 2, 3$, 内部において次数$p^b$の局所多項式空間が備え付けられた基本要素$\mathcal{K}^1_t$を考える。
$H^1$一致性離散化に対する最小法則は任意の$j=1,\ldots, 3$に対して$p^{e_j}\le p^b$を要請する。
基本要素多項式空間空間は以下のようにして構成される。
$$
W_t = \set{w| w\in \mathcal{P}_ {p^b}(K_t), w|_ {e_j} \in \mathcal{P}_ {p^{e_j}}(e_j), j=1, 2, 3}
$$

正則関数$u: K_t \to \mathbb{R}$を考える。
三角形の階層形状関数$K^1_t$において形状関数が
頂点関数$\varphi^{v_1}_ t,\varphi^{v_2}_ t, \varphi^{v_3}_ t$は(2.20)で定義され、
関数$\varphi^{e_1}_ t, \varphi^{e_2}_ t, \varphi^{e_3}_ t$は(2.21)そして、
気泡関数$\varphi^b_{n_1, N-2, t}, \ 1\le n_1, n_2, n_1 + n_2 \le p^b -1$は(2.23)で定義される。

射影補間$u_{h,p}= \Pi^1_ t u\in W_t$は頂点、辺、そして気泡補間の和で構成される。
$$
u_{h,p} = u^v_{h,p} + u^e_{h,p} + u^b_{h,p}
$$

頂点補間$u^v_{h,p} \in W_t$は線形関数であり、$u$は頂点で以下の値を取る。
$$
u^v_{h,p}(v_j) = u(v_j),\ j=1, 2, 3
$$

一次元の場合と同様に、$u^v_{h,p}$を頂点形状関数の線形和として表現することができる。

辺補間$u^e_{h,p}\in W_t$は要素辺の寄与率の和として構成される。
$$
u^e_{h, p} = \sum_{j=1}^3 u^{e_j}_ {h, p}
$$

局所性と一致性の議論により、辺$e_j$に沿った$u^e_{h,p}$ははその辺のみの上の関数$u$の値により依存していなければならない。
つまり、その関数$u$の値は隣接する要素の対応するペアによって共有される唯一の情報である。
近似定理により辺$e_j, \ j=1, 2, 3$上のノルム$H^{1/2}_ {00}(e_j)$において残差$u-u^v_{h,p}$と辺補間$u^e_{h,p}$の間の距離を最小にすることが示唆される。

この非自明なノルムについてりかいするために、ある辺$e_j$と以下の空間について考える。
$$
H^{1/2}_ {00}(e_j) = \set{\tilde{w}|_ {e_j} | \tilde{w}\in H^{1/2}(\partial K_t), \tilde{w}\equiv 0\ on\ \partial K_t\backslash e_j}
$$
ここで$H^{1/2}(\partial K_t)$は$H^1(K_t)$から境界$\partial K_t$への関数のトレース空間である。
関数$\tilde{w}$がこの空間を形成する。
$$
||\tilde{w}||_ {H^{1/2}_ {00}(e_j)} = ||\tilde{w}||_ {H^{1}(K)} = ||\nabla \tilde{w}||_ {L^2(K)}
$$
ここで、$w\in H^1(K_t)$は$\tilde{w}$の要素内部への最小エネルギー拡張である。  
つまり、$K_t$内部で$\Delta w=0$, $e_j$上で$w\equiv \tilde{w}$, 残りの辺上で$w\equiv 0$を満たす関数である。
実際、ノルムの正確な評価は困難で、代わりにおもみずけられた$H^1_0$ノルムで近似する。
